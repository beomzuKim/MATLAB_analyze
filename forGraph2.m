%% 2021.01.02
clc, clear, close all;

ztest = [0 4];
clearanceRatiotest = [0.06 0.05];
degreetest = [0 45 90 135 180 315];

for a = 1:2
    z = ztest(a);
    for b = 1:2
        clearanceRatio = clearanceRatiotest(b);
        for c = 1:6
            degree = degreetest(c)
            
%% experimental condition
z = num2str(z);
clearanceRatio = num2str(clearanceRatio);
degree = num2str(degree);
% z = '0';
% clearanceRatio = '0.06';
% degree = '90';


%% read data
rfname = ['/Users/beomzukim/Documents/MATLAB/research/data2/clearanceratio' clearanceRatio '_z' z '_degree' degree '.csv']
% data = dlmread(rfname, ' ');
% data = clearanceratio0;
% data = table2array(data);
% type clearanceratio0.06_z0_degree0.csv;
data = readtable(rfname,'ReadVariableNames', true);
data = table2array(data);

%% data sub
vtheta_0 = data(:,1); 
vtheta_20 = data(:,2); 
vtheta_32 = data(:,3);
vtheta_44 = data(:,4); 
vtheta_56 = data(:,5);
vr_0 = data(:,6);
vr_20 = data(:,7); 
vr_32 = data(:,8);
vr_44 = data(:,9); 
vr_56 = data(:,10);

vtheta_0 = rmmissing(vtheta_0);
vtheta_20 = rmmissing(vtheta_20);
vtheta_32 = rmmissing(vtheta_32);
vtheta_44 = rmmissing(vtheta_44);
vtheta_56 = rmmissing(vtheta_56);
vr_0 = rmmissing(vr_0);
vr_20 = rmmissing(vr_20);
vr_32 = rmmissing(vr_32);
vr_44 = rmmissing(vr_44);
vr_56 = rmmissing(vr_56);

%% analyze smoothdata
vtheta_0 = smoothdata(vtheta_0,'loess');
vtheta_20 = smoothdata(vtheta_20,'loess');
vtheta_32 = smoothdata(vtheta_32,'loess');
vtheta_44  = smoothdata(vtheta_44,'loess');
vtheta_56 = smoothdata(vtheta_56,'loess');

vr_0 = smoothdata(vr_0,'loess');
vr_20 = smoothdata(vr_20,'loess');
vr_32 = smoothdata(vr_32,'loess');
vr_44 = smoothdata(vr_44,'loess');
vr_56 = smoothdata(vr_56,'loess');

%% define x-axis
x0 = 0.3 : (1-0.3)/(length(vtheta_0)-1) : 1;
x20 = 0.3 : (1-0.3)/(length(vtheta_20)-1) : 1;
x32 = 0.3 : (1-0.3)/(length(vtheta_32)-1) : 1;
x44 = 0.3 : (1-0.3)/(length(vtheta_44)-1) : 1;
x56 = 0.3 : (1-0.3)/(length(vtheta_56)-1) : 1;

xx0 = 0.3 : (1-0.3)/(length(vr_0)-1) : 1;
xx20 = 0.3 : (1-0.3)/(length(vr_20)-1) : 1;
xx32 = 0.3 : (1-0.3)/(length(vr_32)-1) : 1;
xx44 = 0.3 : (1-0.3)/(length(vr_44)-1) : 1;
xx56 = 0.3 : (1-0.3)/(length(vr_56)-1) : 1;

xq = 0.3 : 0.7/39 : 1;

%% interpolation
vth0 = interp1(x0,vtheta_0,xq);
vth20 = interp1(x20,vtheta_20,xq);
vth32 = interp1(x32,vtheta_32,xq);
vth44 = interp1(x44,vtheta_44,xq);
vth56 = interp1(x56,vtheta_56,xq);

vr0 = interp1(xx0,vr_0,xq);
vr20 = interp1(xx20,vr_20,xq);
vr32 = interp1(xx32,vr_32,xq);
vr44 = interp1(xx44,vr_44,xq);
vr56 = interp1(xx56,vr_56,xq);

%% polyfit DEMENSTION10
poly_vr0 = polyfit(xq,vr0,10);
vr0p = (poly_vr0(1)*xq.^10)+ ...
       (poly_vr0(2)*xq.^9) + ...
       (poly_vr0(3)*xq.^8) + ...
       (poly_vr0(4)*xq.^7) + ...
       (poly_vr0(5)*xq.^6) + ...
       (poly_vr0(6)*xq.^5) + ...
       (poly_vr0(7)*xq.^4) + ...
       (poly_vr0(8)*xq.^3) + ...
       (poly_vr0(9)*xq.^2) + ...
       (poly_vr0(10)*xq.^1) + ...
       poly_vr0(11);

poly_vr20 = polyfit(xq,vr20,10);
vr20p = (poly_vr20(1)*xq.^10)+ ...
       (poly_vr20(2)*xq.^9) + ...
       (poly_vr20(3)*xq.^8) + ...
       (poly_vr20(4)*xq.^7) + ...
       (poly_vr20(5)*xq.^6) + ...
       (poly_vr20(6)*xq.^5) + ...
       (poly_vr20(7)*xq.^4) + ...
       (poly_vr20(8)*xq.^3) + ...
       (poly_vr20(9)*xq.^2) + ...
       (poly_vr20(10)*xq.^1) + ...
       poly_vr20(11);
   
poly_vr32 = polyfit(xq,vr32,10);
vr32p = (poly_vr32(1)*xq.^10)+ ...
       (poly_vr32(2)*xq.^9) + ...
       (poly_vr32(3)*xq.^8) + ...
       (poly_vr32(4)*xq.^7) + ...
       (poly_vr32(5)*xq.^6) + ...
       (poly_vr32(6)*xq.^5) + ...
       (poly_vr32(7)*xq.^4) + ...
       (poly_vr32(8)*xq.^3) + ...
       (poly_vr32(9)*xq.^2) + ...
       (poly_vr32(10)*xq.^1) + ...
       poly_vr32(11);
   
poly_vr44 = polyfit(xq,vr44,10);
vr44p = (poly_vr44(1)*xq.^10)+ ...
       (poly_vr44(2)*xq.^9) + ...
       (poly_vr44(3)*xq.^8) + ...
       (poly_vr44(4)*xq.^7) + ...
       (poly_vr44(5)*xq.^6) + ...
       (poly_vr44(6)*xq.^5) + ...
       (poly_vr44(7)*xq.^4) + ...
       (poly_vr44(8)*xq.^3) + ...
       (poly_vr44(9)*xq.^2) + ...
       (poly_vr44(10)*xq.^1) + ...
       poly_vr44(11);
   
poly_vr56 = polyfit(xq,vr56,10);
vr56p = (poly_vr56(1)*xq.^10)+ ...
       (poly_vr56(2)*xq.^9) + ...
       (poly_vr56(3)*xq.^8) + ...
       (poly_vr56(4)*xq.^7) + ...
       (poly_vr56(5)*xq.^6) + ...
       (poly_vr56(6)*xq.^5) + ...
       (poly_vr56(7)*xq.^4) + ...
       (poly_vr56(8)*xq.^3) + ...
       (poly_vr56(9)*xq.^2) + ...
       (poly_vr56(10)*xq.^1) + ...
       poly_vr56(11);
   
% %% polyfit DEMENSTION7
% poly_vr0 = polyfit(xq,vr0,7);
% vr0p = (poly_vr0(1)*xq.^7)+ ...
%        (poly_vr0(2)*xq.^6) + ...
%        (poly_vr0(3)*xq.^5) + ...
%        (poly_vr0(4)*xq.^4) + ...
%        (poly_vr0(5)*xq.^3) + ...
%        (poly_vr0(6)*xq.^2) + ...
%        (poly_vr0(7)*xq.^1) + ...
%         poly_vr0(8);
% 
% poly_vr20 = polyfit(xq,vr20,7);
% vr20p = (poly_vr20(1)*xq.^7)+ ...
%         (poly_vr20(2)*xq.^6) + ...
%         (poly_vr20(3)*xq.^5) + ...
%         (poly_vr20(4)*xq.^4) + ...
%         (poly_vr20(5)*xq.^3) + ...
%         (poly_vr20(6)*xq.^2) + ...
%         (poly_vr20(7)*xq.^1) + ...
%          poly_vr20(8);
%    
% poly_vr32 = polyfit(xq,vr32,7);
% vr32p = (poly_vr32(1)*xq.^7)+ ...
%         (poly_vr32(2)*xq.^6) + ...
%         (poly_vr32(3)*xq.^5) + ...
%         (poly_vr32(4)*xq.^4) + ...
%         (poly_vr32(5)*xq.^3) + ...
%         (poly_vr32(6)*xq.^2) + ...
%         (poly_vr32(7)*xq.^1) + ...
%          poly_vr32(8);
% 
% poly_vr44 = polyfit(xq,vr44,7);
% vr44p = (poly_vr44(1)*xq.^7)+ ...
%         (poly_vr44(2)*xq.^6) + ...
%         (poly_vr44(3)*xq.^5) + ...
%         (poly_vr44(4)*xq.^4) + ...
%         (poly_vr44(5)*xq.^3) + ...
%         (poly_vr44(6)*xq.^2) + ...
%         (poly_vr44(7)*xq.^1) + ...
%          poly_vr44(8);
%    
% poly_vr56 = polyfit(xq,vr56,7);
% vr56p = (poly_vr56(1)*xq.^7)+ ...
%         (poly_vr56(2)*xq.^6) + ...
%         (poly_vr56(3)*xq.^5) + ...
%         (poly_vr56(4)*xq.^4) + ...
%         (poly_vr56(5)*xq.^3) + ...
%         (poly_vr56(6)*xq.^2) + ...
%         (poly_vr56(7)*xq.^1) + ...
%          poly_vr56(8);
%    
%% v_theta
name1 = (['vtheta_' clearanceRatio '_z' z  '_degree' degree]);

figure('Name',name1,'NumberTitle','off');
plot(xq,vth0,'-o');
hold on;
plot(xq,vth20,'-d');
hold on;
plot(xq,vth32,'-s');
hold on;
plot(xq,vth44,'-^');
hold on;
plot(xq,vth56,'-*');
hold off;

set(gca,'FontSize',22)
referenceline = refline(0,1);
referenceline.LineWidth = 2;
referenceline.Color = 'r';
legend('0°','20°','32°','44°','56°');
legend('Location','southwest');

set(legend,'FontSize',16)
xlabel('r/R_2','FontSize',22);
ylabel('V_θ/rΩ','FontSize',22);
xlim([0.3 1]);
ylim([0 1.3]);
saveas(gcf,['vtheta_' clearanceRatio '_z' z  '_degree' degree '.png']);

%% v_r
name2 = (['vr_' clearanceRatio '_z' z  '_degree' degree]);
figure('Name',name2,'NumberTitle','off');
plot(xq,vr0p,'-o');
hold on;
plot(xq,vr20p,'-d');
hold on;
plot(xq,vr32p,'-s');
hold on;
plot(xq,vr44p,'-^');
hold on;
plot(xq,vr56p,'-*');
hold off;

set(gca,'FontSize',22)
referenceline = refline(0,0);
referenceline.LineWidth = 2;
referenceline.Color = 'r';
legend('0°','20°','32°','44°','56°');
legend('Location','northeast');
set(legend,'FontSize',16)
xlabel('r/R_2','FontSize',22);
ylabel('V_r/rΩ','FontSize',22);
xlim([0.3 1]);
ylim([-0.2 0.2]);

saveas(gcf,['vr_' clearanceRatio '_z' z  '_degree' degree '.png']);

        end
    end
end


